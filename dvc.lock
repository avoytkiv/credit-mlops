schema: '2.0'
stages:
  preprocess:
    cmd: python src/stages/preprocessing.py --config=params.yaml
    deps:
    - path: src/stages/preprocessing.py
      hash: md5
      md5: 65286412bb62f64c61ac3e79156ee38a
      size: 1596
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_load:
          dataset_csv: data/raw/Customer_Data.csv
    outs:
    - path: data/processed/processed_data.csv
      hash: md5
      md5: 8aff64ed9940f4339131242b798291d5
      size: 786359
  featurize:
    cmd: python src/stages/featurizing.py --config=params.yaml
    deps:
    - path: data/processed/processed_data.csv
      hash: md5
      md5: 8aff64ed9940f4339131242b798291d5
      size: 786359
    - path: src/stages/featurizing.py
      hash: md5
      md5: b219607904a11df9a5c84496fd6f29e3
      size: 1579
    params:
      params.yaml:
        data_preprocessing:
          dataset_processed: data/processed/processed_data.csv
        featurize:
          features_path: data/processed/featurized_data.csv
          model_path: models/featurizer.pkl
          n_components: 6
    outs:
    - path: data/processed/featurized_data.csv
      hash: md5
      md5: 098a75f41b6ee6a454dda9b9a3ea911a
      size: 864845
    - path: models/featurizer.pkl
      hash: md5
      md5: 84820e6ebd2814e8bd2b4f28f7107479
      size: 2029
  train:
    cmd: python src/stages/training.py --config=params.yaml
    deps:
    - path: data/processed/featurized_data.csv
      hash: md5
      md5: 098a75f41b6ee6a454dda9b9a3ea911a
      size: 864845
    - path: src/stages/training.py
      hash: md5
      md5: 466e58b5ba82e36d6c37bea90213980b
      size: 1765
    - path: src/utils/train_util.py
      hash: md5
      md5: 5faed4f352bccffe6257b08678ad5201
      size: 2131
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        featurize:
          features_path: data/processed/featurized_data.csv
          model_path: models/featurizer.pkl
          n_components: 6
        train:
          cv: 5
          estimator_name: kmeans
          estimators:
            kmeans:
              param_grid:
                n_clusters:
                - 2
                - 3
                - 4
                n_init:
                - 10
            agglo:
              param_grid:
                n_clusters:
                - 2
                - 3
                - 4
                linkage:
                - ward
                - complete
                - average
            dbscan:
              param_grid:
                eps:
                - 0.3
                - 0.5
                min_samples:
                - 5
                - 10
          model_path: models/model.pkl
    outs:
    - path: models/model.pkl
      hash: md5
      md5: ed0d857ea862a72b1ab312b83fa1fcbd
      size: 30288
    - path: reports/metrics.json
      hash: md5
      md5: bbab00c4978e5d5e1e9af32cacf776e0
      size: 42
  visualize:
    cmd: python src/stages/visualizing.py --config=params.yaml
    deps:
    - path: data/processed/processed_data.csv
      hash: md5
      md5: 8aff64ed9940f4339131242b798291d5
      size: 786359
    - path: models/featurizer.pkl
      hash: md5
      md5: 84820e6ebd2814e8bd2b4f28f7107479
      size: 2029
    - path: models/model.pkl
      hash: md5
      md5: ed0d857ea862a72b1ab312b83fa1fcbd
      size: 30288
    - path: src/stages/visualizing.py
      hash: md5
      md5: c6400af1746f690e0b813a8c91881050
      size: 1546
    - path: src/utils/visualize_util.py
      hash: md5
      md5: 4f34ab90ff70386ed43addb820aab79a
      size: 2414
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_preprocessing:
          dataset_processed: data/processed/processed_data.csv
        reports:
          reports_dir: reports
          plots_dir: reports/figures
          metrics_file: metrics.json
          silhouette_plot: silhouette_plot.png
          elbow_plot: elbow_plot.png
    outs:
    - path: reports/figures/clusters.png
      hash: md5
      md5: fb694a36fb1c4d9eae05af826502ca30
      size: 53334
