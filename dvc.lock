schema: '2.0'
stages:
  preprocess:
    cmd: python src/stages/preprocessing.py --config=params.yaml
    deps:
    - path: src/stages/preprocessing.py
      hash: md5
      md5: 2d91397f8c9a4c72dc46bb3ae860296b
      size: 1297
    params:
      params.yaml:
        base.log_level: INFO
        data.data_load: data/raw/Customer_Data.csv
    outs:
    - path: data/processed/processed_data.csv
      hash: md5
      md5: 8aff64ed9940f4339131242b798291d5
      size: 786359
  featurize:
    cmd: python src/stages/featurizing.py --config=params.yaml
    deps:
    - path: data/processed/processed_data.csv
      hash: md5
      md5: 8aff64ed9940f4339131242b798291d5
      size: 786359
    - path: src/stages/featurizing.py
      hash: md5
      md5: 9298aa15fa4d538b2e5dbf2eb8d86b57
      size: 7752
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data.data_preprocessing: data/processed/processed_data.csv
        featurize:
          featurizer_name: autoencoder
          featurizer_path: models/featurizer.keras
          model_name: model1
          model_path: models/autoencoder/
          parameters:
            encoding_dim: 6
          hyperparameters:
            encoder_activation: tanh
            decoder_activation: tanh
            optimizer: adam
            loss: binary_crossentropy
            epochs: 15
            batch_size: 64
    outs:
    - path: data/processed/featurized_data.csv
      hash: md5
      md5: bea08531b57606b56524b72fc2273b1e
      size: 283939
    - path: models/featurizer.keras
      hash: md5
      md5: 6b887b954a03852867a07b38ffdb6cf7
      size: 9201533
  train:
    cmd: python src/stages/training.py --config=params.yaml
    deps:
    - path: data/processed/featurized_data.csv
      hash: md5
      md5: bea08531b57606b56524b72fc2273b1e
      size: 283939
    - path: src/stages/training.py
      hash: md5
      md5: c4775ef76fedeadc6b1152cb5506ecdc
      size: 1597
    - path: src/utils/train_util.py
      hash: md5
      md5: e36d8c2a040e865e9f1f08d196dacba4
      size: 2347
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        train:
          model_path: models/model.pkl
          model:
            model_name: kmeans
            param_grid:
              n_clusters:
              - 2
              - 3
              - 4
              - 5
              - 6
              n_init:
              - 10
    outs:
    - path: data/processed/labeled_data.csv
      hash: md5
      md5: 83fd5feb15399d49a25a57b8dc8be520
      size: 298639
    - path: models/model.pkl
      hash: md5
      md5: c738859129fe31b3974c700ef7ae5a18
      size: 30240
    - path: reports/metrics.json
      hash: md5
      md5: 7627af67409156a8ec9a766232a71ebb
      size: 42
  visualize:
    cmd: python src/stages/visualization.py --config=params.yaml
    deps:
    - path: data/processed/labeled_data.csv
      hash: md5
      md5: 83fd5feb15399d49a25a57b8dc8be520
      size: 298639
    - path: data/processed/processed_data.csv
      hash: md5
      md5: 8aff64ed9940f4339131242b798291d5
      size: 786359
    - path: src/stages/visualization.py
      hash: md5
      md5: 9dd272a8cbe9369598b7b679f40c6038
      size: 5462
    params:
      params.yaml:
        reports:
          base_dir: reports
          plots_dir: figures
          metrics_file: metrics.json
          plots:
            silhouette: silhouette_plot.png
            elbow: elbow_plot.png
            clusters: clusters.png
            comparison: comparison.png
            frequency: frequency.png
        visualization:
          n_components: 2
          perplexity: 50
          learning_rate: 500
          n_iter: 3000
    outs:
    - path: reports/figures/clusters.png
      hash: md5
      md5: c02067578d858053d9cfecb96187f1e5
      size: 98901
    - path: reports/figures/comparison.png
      hash: md5
      md5: 767e2f6879af7c8d8dbc771d500645f4
      size: 297970
    - path: reports/figures/frequency.png
      hash: md5
      md5: 0fa48f4ee67f875d8c209c453bb8340e
      size: 18447
