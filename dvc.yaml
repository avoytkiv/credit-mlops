stages:
  preprocess:
    cmd: python src/stages/preprocessing.py --config=params.yaml
    deps:
    - src/stages/preprocessing.py
    params:
    - base
    - data_load
    outs:
    - data/processed/processed_data.csv
  
  featurize:
    cmd: python src/stages/featurizing.py --config=params.yaml
    deps:
    - data/processed/processed_data.csv
    - src/stages/featurizing.py
    params:
    - data_preprocessing
    - featurize
    outs:
    - data/processed/featurized_data.csv
    - models/featurizer.pkl
  
  train:
    cmd: python src/stages/training.py --config=params.yaml
    deps:
    - data/processed/featurized_data.csv
    - src/stages/training.py
    - src/utils/train_util.py
    params:
    - base
    - featurize
    - train
    outs:
    - models/model.pkl
    metrics:
    - reports/metrics.json:
        cache: false

  visualize:
    cmd: python src/stages/visualizing.py --config=params.yaml
    deps:
    - data/processed/processed_data.csv
    - models/model.pkl
    - models/featurizer.pkl
    - src/stages/visualizing.py
    - src/utils/visualize_util.py
    params:
    - base
    - data_preprocessing
    - reports
    plots:
    - reports/figures/clusters.png:
        cache: false